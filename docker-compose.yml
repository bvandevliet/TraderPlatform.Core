version: '3.4'

services:

  traderplatform.database:
    image: mariadb:latest

  # traderplatform.redis:
  #   image: redis:alpine

  traderplatform.nginx:
    image: nginx:alpine

  traderplatform.engine:
    image: ${DOCKER_REGISTRY-}traderplatform-engine
    build:
      context: .
      dockerfile: TraderPlatform.Engine/Dockerfile
    environment:
      - ASPNETCORE_URLS=https://+:${PORT_ENGINE_SSL};http://+:${PORT_ENGINE}

  traderplatform.api:
    image: ${DOCKER_REGISTRY-}traderplatform-api
    build:
      context: .
      dockerfile: TraderPlatform.API/Dockerfile
    environment:
      - ASPNETCORE_URLS=https://+:${PORT_API_SSL};http://+:${PORT_API}
    ports:
      - "${PORT_API}:${PORT_API}"
      - "${PORT_API_SSL}:${PORT_API_SSL}"

  traderplatform.daemon:
    image: ${DOCKER_REGISTRY-}traderplatform-daemon
    build:
      context: .
      dockerfile: TraderPlatform.Daemon/Dockerfile
